"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3270],{3270:(H,Z,c)=>{c.r(Z),c.d(Z,{MedicoPageModule:()=>z});var h=c(6895),g=c(433),l=c(8058),f=c(7469),u=c(655),p=c(6534),y=c(6204),x=c(53),m=c(6916),M=c(7423),v=(()=>{return(i=v||(v={})).Documents="DOCUMENTS",i.Data="DATA",i.Library="LIBRARY",i.Cache="CACHE",i.External="EXTERNAL",i.ExternalStorage="EXTERNAL_STORAGE",v;var i})(),_=(()=>{return(i=_||(_={})).UTF8="utf8",i.ASCII="ascii",i.UTF16="utf16",_;var i})();const A=(0,M.fo)("Filesystem",{web:()=>c.e(6364).then(c.bind(c,6364)).then(i=>new i.FilesystemWeb)});var e=c(8274),U=c(5014),C=c(4465),D=c(2722),F=c(1360),S=c(9201),T=c(2216);function N(i,d){if(1&i&&(e.TgZ(0,"div")(1,"div",18),e._UZ(2,"fa-icon",19),e._uU(3,"\xa0 "),e.TgZ(4,"a",20),e._uU(5),e.qZA()(),e.TgZ(6,"div",18),e._UZ(7,"fa-icon",21),e._uU(8,"\xa0 "),e.TgZ(9,"a",20),e._uU(10),e.qZA()(),e.TgZ(11,"div",18),e._UZ(12,"fa-icon",22),e._uU(13,"\xa0 "),e.TgZ(14,"a",20),e._uU(15),e.qZA()()()),2&i){const t=e.oxw(2);e.xp6(4),e.MGl("href","mailto://",t.myDoc.email,"",e.LSH),e.xp6(1),e.Oqu(t.myDoc.email),e.xp6(4),e.MGl("href","https://maps.google.com/?q=",t.myDoc.address,"",e.LSH),e.xp6(1),e.Oqu(t.myDoc.address),e.xp6(4),e.MGl("href","tel://",t.myDoc.tel,"",e.LSH),e.xp6(1),e.Oqu(t.myDoc.tel)}}function I(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div",23)(1,"div",24)(2,"div",25),e._uU(3,"Ragione Sociale"),e.qZA(),e.TgZ(4,"div",26),e._uU(5),e.qZA()(),e.TgZ(6,"div",24)(7,"div",25),e._uU(8,"Partita IVA"),e.qZA(),e.TgZ(9,"div",26),e._uU(10),e.qZA()(),e.TgZ(11,"div",24)(12,"div",25),e._uU(13,"Costo Orario"),e.qZA(),e.TgZ(14,"div",26),e._uU(15),e.qZA()(),e.TgZ(16,"div",24)(17,"div",25),e._uU(18,"Indirizzo PayPal"),e.qZA(),e.TgZ(19,"div",26),e._uU(20),e.qZA()(),e.TgZ(21,"ion-button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.scollegaMedico())}),e._uU(22,"SCOLLEGA MEDICO"),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(5),e.Oqu(t.myDoc.rag_soc),e.xp6(5),e.Oqu(t.myDoc.piva),e.xp6(5),e.hij("",t.myDoc.hr," \u20ac"),e.xp6(5),e.Oqu(t.myDoc.paypal)}}function P(i,d){if(1&i&&(e.TgZ(0,"div")(1,"div",13)(2,"div",14),e._UZ(3,"img",15),e.qZA(),e.TgZ(4,"div",16),e._uU(5),e.qZA(),e.YNc(6,N,16,6,"div",12),e.qZA(),e.YNc(7,I,23,4,"div",17),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.s9C("src",t.myDoc.photo||"assets/icon/mental-space-website-favicon-color.png",e.LSH),e.xp6(2),e.Oqu(t.myDoc.full_name||"Non Ancora Scelto"),e.xp6(1),e.Q6J("ngIf",t.myDoc.full_name.length>0),e.xp6(1),e.Q6J("ngIf",t.myDoc.full_name.length>0)}}function L(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"ion-card-content")(1,"form",28,29),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.MAs(2),o=e.oxw();return e.KtG(o.submitInvitation(a))}),e.TgZ(3,"ion-item",30)(4,"ion-label",31),e._uU(5,"Indirizzo E-Mail"),e.qZA(),e.TgZ(6,"ion-input",32),e.NdJ("ngModelChange",function(a){e.CHM(t);const o=e.oxw();return e.KtG(o.myDoc.email=a)}),e.qZA()(),e.TgZ(7,"ion-button",33),e._uU(8,"INVITA"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.myDoc.email)}}function J(i,d){1&i&&(e.TgZ(0,"ul",36)(1,"li")(2,"div",4)(3,"div",40)(4,"span",16),e._uU(5,"ANCORA NULLA"),e.qZA()(),e.TgZ(6,"div",41),e._UZ(7,"span",42),e.qZA()()()())}function O(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"li")(1,"div",4)(2,"div",40)(3,"span",16),e._uU(4),e.qZA()(),e.TgZ(5,"div",41)(6,"span",42)(7,"a",43),e.NdJ("click",function(){const o=e.CHM(t).$implicit,s=e.oxw(2);return e.KtG(s.downloadFile(o.value))}),e._UZ(8,"fa-icon",44),e._uU(9," DOWNLOAD"),e.qZA(),e._uU(10," | "),e.TgZ(11,"a",45),e._UZ(12,"fa-icon",46),e._uU(13," ELIMINA"),e.qZA()()()()()}if(2&i){const t=d.$implicit;e.xp6(4),e.Oqu(t.value)}}function q(i,d){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e._UZ(2,"br"),e._uU(3),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij(" Totale da Inviare: ",t.totalToSend,""),e.xp6(2),e.hij(" Totale Inviato: ",t.totalSent," ")}}function b(i,d){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",34),e._uU(2,"I Miei Files"),e.qZA(),e.YNc(3,J,8,0,"ul",35),e.TgZ(4,"ul",36),e.YNc(5,O,14,1,"li",37),e.ALo(6,"keyvalue"),e.qZA(),e.TgZ(7,"p"),e._uU(8,"File da caricare "),e.TgZ(9,"input",38),e.NdJ("change",function(a){e.CHM(t);const o=e.oxw();return e.KtG(o.onFileChange(a))}),e.qZA()(),e.TgZ(10,"ion-button",39),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.uploadFile())}),e._uU(11,"Carica File"),e.qZA(),e.YNc(12,q,4,2,"div",12),e.qZA()}if(2&i){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",0===t.fileLists.length),e.xp6(2),e.Q6J("ngForOf",e.lcZ(6,3,t.fileLists)),e.xp6(7),e.Q6J("ngIf",0!==t.totalToSend)}}const R=function(){return["/dashboard"]},w=[{path:"",component:(()=>{class i{constructor(t,n,a,o,s){this.storageService=t,this.toastCtrl=n,this.loadingCtrl=a,this.router=o,this.fileOpener=s,this.totalSent=0,this.totalToSend=0,this.myDoc={pic:"",full_name:"",email:"",doc_id:void 0,paypal:void 0,photo:void 0,piva:void 0,rag_soc:void 0,tel:void 0,address:void 0,hr:void 0},this.segment="doc_profile"}ngOnInit(){this.api=m.N.apiURL,this.getMyDoctor(),this.listMyFiles()}downloadFile(t){return(0,u.mG)(this,void 0,void 0,function*(){let n;yield this.storageService.get("access_token").then(o=>{n=o});let a=new FormData;a.append("file_name",t),(0,p.Z)({method:"post",url:m.N.apiURL+"mobile/api/patient/file/download",data:a,responseType:"stream",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/octet-stream"}}).then(o=>(0,u.mG)(this,void 0,void 0,function*(){let s;s=o.data,yield A.writeFile({data:s,path:t,directory:v.Data,encoding:_.UTF8,recursive:!0}).then(r=>this.fileOpener.showOpenWithDialog(r.uri,"").then(()=>console.log("file opened")).catch(Y=>console.log("err",Y))).catch(r=>console.log("error",r))}))})}onFileChange(t){this.file=t.target.files[0]}uploadFile(){return(0,u.mG)(this,void 0,void 0,function*(){const t=yield this.loadingCtrl.create({message:"Caricamento file in corso...",spinner:"circles"});t.present();var n=new FormData;let a;n.append("file",this.file,this.file.name),yield this.storageService.get("access_token").then(s=>{a=s}),p.Z.post(m.N.apiURL+"mobile/api/patient/file/upload",n,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"multipart/form-data"},onUploadProgress:s=>{this.totalSent=s.loaded,this.totalToSend=s.total}}).then(s=>{console.log(s),this.toastCtrl.presentToast("Invito Inviato con Successo"),this.listMyFiles(),t.dismiss()}).catch(s=>{console.log("axios error",s),this.toastCtrl.presentToast(s.message),t.dismiss()}),t.dismiss()})}listMyFiles(){return(0,u.mG)(this,void 0,void 0,function*(){let t;yield this.storageService.get("access_token").then(a=>{t=a}),p.Z.get(m.N.apiURL+"mobile/api/patient/file/list",{headers:{Authorization:`Bearer ${t}`}}).then(a=>{this.fileLists=a.data.files}).catch(a=>{console.log("axios error",a)})})}handleRefresh(t){setTimeout(()=>{this.getMyDoctor(),this.listMyFiles(),t.target.complete()},2e3)}submitInvitation(t){return(0,u.mG)(this,void 0,void 0,function*(){const n=yield this.loadingCtrl.create({message:"Caricamento...",spinner:"circles"});n.present();const a={doc_email:t.value.doc_email};let o;yield this.storageService.get("access_token").then(r=>{o=r});const s={headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/x-wwww-form-urlencoded"}};p.Z.post(m.N.apiURL+"mobile/api/invite/doctor",JSON.stringify(a),s).then(r=>{this.toastCtrl.presentToast("Invito Inviato con Successo"),n.dismiss()}).catch(r=>{console.log("axios error",r),this.toastCtrl.presentToast(r.message),n.dismiss()}),n.dismiss()})}getMyDoctor(){return(0,u.mG)(this,void 0,void 0,function*(){const t=yield this.loadingCtrl.create({message:"Caricamento...",spinner:"circles"});let n;t.present(),yield this.storageService.get("access_token").then(o=>{n=o}),p.Z.get(m.N.apiURL+"mobile/api/patient/my_doctor",{headers:{Authorization:`Bearer ${n}`}}).then(o=>{this.myDoc.full_name=o.data[0].doc_name+" "+o.data[0].doc_surname,this.myDoc.doc_id=o.data[0].doc_id,this.myDoc.paypal=o.data[0].doc_paypal,this.myDoc.photo=o.data[0].doc_photo||"https://www.gravatar.com/avatar/"+y.V8.hashStr(this.myDoc.email),this.myDoc.piva=o.data[0].doc_piva,this.myDoc.rag_soc=o.data[0].doc_rag_soc,this.myDoc.tel=o.data[0].doc_tel,this.myDoc.email=o.data[0].email,this.myDoc.address=o.data[0].doc_address,this.myDoc.hr=o.data[0].doc_hourlyrate,t.dismiss()}).catch(o=>{console.log("axios error",o),this.toastCtrl.presentToast(o.message),t.dismiss()}),t.dismiss()})}scollegaMedico(){return(0,u.mG)(this,void 0,void 0,function*(){const t=yield this.loadingCtrl.create({message:"Caricamento...",spinner:"circles"});let n;t.present(),yield this.storageService.get("access_token").then(s=>{n=s});const a={headers:{Authorization:`Bearer ${n}`}};(yield x.V.confirm({title:"Attenzione",message:"Sicuro di voler scollegare il Tuo Medico ?"})).value&&(p.Z.get(m.N.apiURL+"mobile/api/patient/scollega_doc",a).then(s=>{this.myDoc={pic:"",full_name:"",email:"",doc_id:void 0,paypal:void 0,photo:void 0,piva:void 0,rag_soc:void 0,tel:void 0,address:void 0,hr:void 0},t.dismiss(),window.location.reload()}).catch(s=>{console.log("axios error",s),this.toastCtrl.presentToast(s.message),t.dismiss()}),t.dismiss()),t.dismiss()})}segmentChanged(t){this.segment=t.detail.value}onSubmit(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(U.V),e.Y36(C.k),e.Y36(l.HT),e.Y36(f.F0),e.Y36(D.u))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-medico"]],decls:24,vars:5,consts:[[1,"profile","page-background"],["slot","fixed",3,"ionRefresh"],[1,"container"],[1,"header"],[1,"row"],[1,"col-8"],[1,"back-btn",3,"routerLink"],["icon","angle-left"],[1,"title"],["value","doc_profile","color","light",3,"ionChange"],["value","doc_profile","color","light"],["value","files","color","light"],[4,"ngIf"],[1,"top-part"],[1,"profile-pic"],[1,"w-100",3,"src"],[1,"name"],["class","activities",4,"ngIf"],[1,"position"],["icon","mail-reply"],[2,"color","white","font-weight","bold",3,"href"],["icon","location"],["icon","phone"],[1,"activities"],[1,"box"],[1,"label"],[1,"value"],["color","danger","expand","full",3,"click"],["novalidate","",3,"ngSubmit"],["form","ngForm"],["lines","full"],["position","floating"],["type","email","required","","ngControl","doc_email","name","doc_email","placeholder","indirizzo@email.it",3,"ngModel","ngModelChange"],["expand","full","type","submit"],[1,"main-subtitle"],["class","report-list",4,"ngIf"],[1,"report-list"],[4,"ngFor","ngForOf"],["type","file","name","file","id","file",3,"change"],["color","light","expand","full",3,"click"],[1,"col-6"],[1,"col-6","text-right"],[1,"date"],[3,"click"],["icon","download"],[1,"btn-danger"],["icon","delete-left"]],template:function(t,n){1&t&&(e._UZ(0,"app-sidebar"),e.TgZ(1,"ion-content",0)(2,"ion-refresher",1),e.NdJ("ionRefresh",function(o){return n.handleRefresh(o)}),e._UZ(3,"ion-refresher-content"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"a",6),e._UZ(9,"fa-icon",7),e.qZA(),e.TgZ(10,"span",8),e._uU(11,"Il Mio Medico"),e.qZA()()(),e.TgZ(12,"div",4)(13,"ion-segment",9),e.NdJ("ionChange",function(o){return n.segmentChanged(o)}),e.TgZ(14,"ion-segment-button",10)(15,"ion-label"),e._uU(16," Dettaglio Medico "),e.qZA()(),e.TgZ(17,"ion-segment-button",11)(18,"ion-label"),e._uU(19," File Condivisi "),e.qZA()()()()(),e.YNc(20,P,8,4,"div",12),e.YNc(21,L,9,1,"ion-card-content",12),e.YNc(22,b,13,5,"div",12),e.qZA()(),e._UZ(23,"app-footerbtn")),2&t&&(e.xp6(8),e.Q6J("routerLink",e.DdM(4,R)),e.xp6(12),e.Q6J("ngIf","doc_profile"===n.segment),e.xp6(1),e.Q6J("ngIf",0===n.myDoc.full_name.length),e.xp6(1),e.Q6J("ngIf","files"===n.segment))},dependencies:[h.sg,h.O5,g._Y,g.JJ,g.JL,g.Q7,g.On,g.F,l.YG,l.FN,l.W2,l.pK,l.Ie,l.Q$,l.nJ,l.Wo,l.cJ,l.GO,l.QI,l.j9,l.Fo,f.rH,F.U,S.k,T.BN,h.Nd]}),i})()}];let G=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[f.Bz.forChild(w),f.Bz]}),i})();var E=c(5642);let z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[h.ez,g.u5,l.Pc,G,E.K,T.uH]}),i})()}}]);