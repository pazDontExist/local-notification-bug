"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1025],{1025:(M,m,n)=>{n.r(m),n.d(m,{LoginPageModule:()=>O});var h=n(6895),a=n(433),g=n(8058),v=n(7469),l=n(655);function i(t){this.message=t}(i.prototype=new Error).name="InvalidCharacterError";var u=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var s=String(t).replace(/=+$/,"");if(s.length%4==1)throw new i("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,r,c=0,d=0,S="";r=s.charAt(d++);~r&&(o=c%4?64*o+r:r,c++%4)?S+=String.fromCharCode(255&o>>(-2*c&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return S};function f(t){this.message=t}(f.prototype=new Error).name="InvalidTokenError";var e=n(8274),C=n(6858),w=n(5014);let D=(()=>{class t{constructor(o,r,c){this.httpService=o,this.storageService=r,this.router=c}login(o){return this.httpService.post("user_login",o)}signup(o){return this.httpService.post("signup",o)}logout(){this.storageService.removeStorageItem("access_token").then(o=>{this.router.navigate(["/login"])})}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(C.O),e.LFG(w.V),e.LFG(v.F0))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var A=n(4465),P=n(2216);const L=function(){return{standalone:!0}},E=function(){return["/register"]},F=[{path:"",component:(()=>{class t{constructor(o,r,c,d,S){this.router=o,this.authService=r,this.storageService=c,this.toastService=d,this.loadingCtrl=S,this.postData={username:"",password:"",role:"patient"}}validateInputs(){let o=this.postData.username.trim(),r=this.postData.password.trim();return this.postData.username&&this.postData.password&&o.length>0&&r.length>0}loginAction(){return(0,l.mG)(this,void 0,void 0,function*(){const o=yield this.loadingCtrl.create({message:"Caricamento...",spinner:"circles"});o.present(),this.validateInputs()?this.authService.login(this.postData).subscribe(r=>{"success"==r.status?(this.storageService.store("access_token",r.access_token),this.storageService.store("expires_in",r.expires_in),this.storageService.store("token_type",r.token_type),this.storageService.store("user_data",function y(t,s){if("string"!=typeof t)throw new f("Invalid token specified");var o=!0===(s=s||{}).header?0:1;try{return JSON.parse(function p(t){var s=t.replace(/-/g,"+").replace(/_/g,"/");switch(s.length%4){case 0:break;case 2:s+="==";break;case 3:s+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(u(s).replace(/(.)/g,function(r,c){var d=c.charCodeAt(0).toString(16).toUpperCase();return d.length<2&&(d="0"+d),"%"+d}))}catch(o){return u(s)}}(t.split(".")[o]))}catch(r){throw new f("Invalid token specified: "+r.message)}}(r.access_token)),this.toastService.presentToast("Login effettuato con successo"),this.router.navigate(["dashboard"]),o.dismiss()):(this.toastService.presentToast("Errore Login"),o.dismiss())},r=>{this.toastService.presentToast("Errore: "+r.error.message),o.dismiss()}):(yield this.toastService.presentToast("Perfavore inserisci dati login"),yield o.dismiss())})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(v.F0),e.Y36(D),e.Y36(w.V),e.Y36(A.k),e.Y36(g.HT))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-login"]],decls:24,vars:8,consts:[[1,"auth-page","page-background"],[3,"ngSubmit"],["form","ngForm"],[1,"container"],[1,"logo"],[1,"logo-image"],["src","../../assets/mental-space-logo/png/logo-white.png",1,"width-100"],[1,"form-middle"],[1,"form-group"],["type","text","id","email","placeholder","E-Mail","required","required",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[1,"form-group","iconpwd-left"],["type","password","id","password","placeholder","Password","required","required",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[1,"forget-password-btn","text-center"],[1,"footer"],[1,"left","text-center"],["type","submit",1,"btn","btn-primary","margin-top-30"],["icon","arrow-right"],[1,"right"],[1,"black-btn",3,"routerLink"],["src","../../../assets/images/register.png",1,"w-100"]],template:function(o,r){1&o&&(e.TgZ(0,"ion-content",0)(1,"form",1,2),e.NdJ("ngSubmit",function(){return r.loginAction()}),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"img",6),e.qZA()(),e.TgZ(7,"div",7)(8,"div",8)(9,"input",9),e.NdJ("ngModelChange",function(d){return r.postData.username=d}),e.qZA()(),e.TgZ(10,"div",10)(11,"input",11),e.NdJ("ngModelChange",function(d){return r.postData.password=d}),e.qZA()(),e.TgZ(12,"div",12)(13,"a"),e._uU(14,"Password dimenticata ?"),e.qZA()()()(),e.TgZ(15,"div",13)(16,"div",14)(17,"button",15),e._uU(18,"Entra "),e._UZ(19,"fa-icon",16),e.qZA()(),e.TgZ(20,"div",17)(21,"a",18)(22,"span"),e._UZ(23,"img",19),e.qZA()()()()()()),2&o&&(e.xp6(9),e.Q6J("ngModel",r.postData.username)("ngModelOptions",e.DdM(5,L)),e.xp6(2),e.Q6J("ngModel",r.postData.password)("ngModelOptions",e.DdM(6,L)),e.xp6(10),e.Q6J("routerLink",e.DdM(7,E)))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.On,a.F,g.W2,g.Fo,v.rH,P.BN]}),t})()}];let I=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[v.Bz.forChild(F),v.Bz]}),t})(),O=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,a.u5,g.Pc,I,P.uH]}),t})()},5014:(M,m,n)=>{n.d(m,{V:()=>l});var h=n(655);const g=(0,n(7423).fo)("Preferences",{web:()=>n.e(8359).then(n.bind(n,8359)).then(i=>new i.PreferencesWeb)});var v=n(8274);let l=(()=>{class i{constructor(){}store(p,f){return(0,h.mG)(this,void 0,void 0,function*(){const y=btoa(escape(JSON.stringify(f)));yield g.set({key:p,value:y})})}get(p){return(0,h.mG)(this,void 0,void 0,function*(){const f=yield g.get({key:p});try{return JSON.parse(unescape(atob(f.value)))}catch(y){return!1}})}removeStorageItem(p){return(0,h.mG)(this,void 0,void 0,function*(){yield g.remove({key:p})})}clear(){return(0,h.mG)(this,void 0,void 0,function*(){yield g.clear()})}}return i.\u0275fac=function(p){return new(p||i)},i.\u0275prov=v.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},4465:(M,m,n)=>{n.d(m,{k:()=>v});var h=n(655),a=n(8274),g=n(8058);let v=(()=>{class l{constructor(u){this.toastController=u}presentToast(u){return(0,h.mG)(this,void 0,void 0,function*(){yield(yield this.toastController.create({message:u,duration:2e3})).present()})}}return l.\u0275fac=function(u){return new(u||l)(a.LFG(g.yF))},l.\u0275prov=a.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()}}]);