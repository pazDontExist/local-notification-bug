"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8668],{8668:(T,v,r)=>{r.r(v),r.d(v,{DiarioPageModule:()=>E});var g=r(6895),p=r(433),s=r(8058),h=r(7469),f=r(655),l=r(6534),_=r(6916),u=r(53),t=r(8274),y=r(5014),x=r(4465),Z=r(3971),D=r(2216);function A(i,c){1&i&&(t.TgZ(0,"ion-card",17)(1,"ion-card-header")(2,"ion-card-title"),t._uU(3,"ANCORA NULLA"),t.qZA()(),t.TgZ(4,"ion-card-content"),t._uU(5," Sentiti libero/a di scrivere quando vuoi :) "),t.qZA()())}function C(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-card",17)(1,"ion-card-header")(2,"ion-card-title"),t._uU(3),t.ALo(4,"date"),t.qZA()(),t._UZ(5,"ion-card-content",18),t.ALo(6,"slice"),t.TgZ(7,"ion-button",19),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.readEntry(a.creation_date,a.content))}),t._uU(8,"LEGGI"),t.qZA(),t.TgZ(9,"ion-button",20),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.delEntry(a.diary_id))}),t._uU(10,"ELIMINA"),t.qZA()()}if(2&i){const e=c.$implicit;t.xp6(3),t.Oqu(t.xi3(4,2,e.creation_date,"dd/MM/yyyy H:mm:ss")),t.xp6(2),t.Q6J("innerHTML",t.Dn7(6,5,e.content,0,100),t.oJD)}}const M=function(){return{language:"it_IT",language_url:"/assets/l18n/tiny/it.js",plugins:"lists link image table code wordcount",toolbar:"undo redo | blocks | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | help"}};function O(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",21)(3,"ion-button",22),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.cancelModal())}),t._uU(4,"Annulla"),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6,"Il Mio Diario"),t.qZA(),t.TgZ(7,"ion-buttons",23)(8,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.confirmModal())}),t._uU(9,"Salva"),t.qZA()()()(),t.TgZ(10,"ion-content",25)(11,"editor",26),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.myDiary=o)}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(8),t.Q6J("strong",!0),t.xp6(3),t.Q6J("init",t.DdM(3,M))("ngModel",e.myDiary)}}function J(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",21)(3,"ion-button",22),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.setOpen(!1))}),t._uU(4,"Chiudi"),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6,"Il Mio Post"),t.qZA()()(),t.TgZ(7,"ion-content",25)(8,"ion-card",17)(9,"ion-card-header")(10,"ion-card-title"),t._uU(11),t.ALo(12,"date"),t.qZA()(),t._UZ(13,"ion-card-content",18),t.TgZ(14,"ion-button",22),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.updateEntry())}),t._uU(15,"MODIFICA"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(11),t.Oqu(t.xi3(12,2,e.entrie.creation_date,"dd/MM/yyyy H:mm:ss")),t.xp6(2),t.Q6J("innerHTML",e.entrie.content,t.oJD)}}function k(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",21)(3,"ion-button",22),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.setOpenEdit(!1))}),t._uU(4,"Chiudi"),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6,"Modifica Post"),t.qZA()()(),t.TgZ(7,"ion-content",25)(8,"ion-card",17)(9,"ion-card-header")(10,"ion-card-title"),t._uU(11),t.ALo(12,"date"),t.qZA()(),t.TgZ(13,"ion-card-content")(14,"editor",27),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.myDiaryEdit=o)}),t.qZA()(),t.TgZ(15,"ion-button",22),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.updateEntry())}),t._uU(16,"SALVA"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(11),t.Oqu(t.xi3(12,4,e.entrie.creation_date,"dd/MM/yyyy H:mm:ss")),t.xp6(3),t.s9C("initialValue",e.entrie.content),t.Q6J("init",t.DdM(7,M))("ngModel",e.myDiaryEdit)}}const N=function(){return["/dashboard"]},U=[{path:"",component:(()=>{class i{constructor(e,n,o){this.loadingCtrl=e,this.storageService=n,this.toastCtrl=o,this.entrie={creation_date:"",content:""},this.isModalOpen=!1,this.isModalEditOpen=!1}ngOnInit(){return(0,f.mG)(this,void 0,void 0,function*(){const e=yield this.loadingCtrl.create({message:"Caricamento in corso...",spinner:"circles"});let n;e.present(),yield this.storageService.get("access_token").then(a=>{n=a}),l.Z.get(_.N.apiURL+"mobile/api/patient/diary",{headers:{Authorization:`Bearer ${n}`}}).then(a=>{this.myEntries=a.data.entries,e.dismiss()}).catch(a=>{console.log("axios error",a),this.toastCtrl.presentToast(a.message),e.dismiss()})})}onWillDismiss(e){const n=event;"confirm"===n.detail.role&&this.myDiary&&(this.myDiary=`${n.detail.data}`,this.uploadDiario())}cancelModal(){this.modal.dismiss(null,"cancel")}confirmModal(){this.modal.dismiss(this.myDiary,"confirm")}uploadDiario(){return(0,f.mG)(this,void 0,void 0,function*(){const e=yield this.loadingCtrl.create({message:"Salvataggio in corso...",spinner:"circles"});let n;e.present(),yield this.storageService.get("access_token").then(d=>{n=d});const o={headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/x-wwww-form-urlencoded"}};l.Z.post(_.N.apiURL+"mobile/api/patient/diary",JSON.stringify({diario:this.myDiary}),o).then(d=>{this.toastCtrl.presentToast(d.data.message),e.dismiss(),this.ngOnInit()}).catch(d=>{console.log("axios error",d),this.toastCtrl.presentToast(d.message),e.dismiss()})})}setOpen(e){this.isModalOpen=e}readEntry(e,n){this.entrie.creation_date=e,this.entrie.content=n,this.setOpen(!0)}delEntry(e){return(0,f.mG)(this,void 0,void 0,function*(){if(!0===(yield u.V.confirm({title:"Attenzione",message:"Sicuro di voler cancellare questo elemento ?"})).value){const o=yield this.loadingCtrl.create({message:"Elimninazione in corso...",spinner:"circles"});let a;o.present(),yield this.storageService.get("access_token").then(m=>{a=m}),l.Z.get(_.N.apiURL+"mobile/api/patient/diary/delete/"+e,{headers:{Authorization:`Bearer ${a}`}}).then(m=>{this.toastCtrl.presentToast(m.data.message),o.dismiss(),this.ngOnInit()}).catch(m=>{console.log("axios error",m),this.toastCtrl.presentToast(m.message),o.dismiss()})}})}updateEntry(){this.setOpenEdit(!0),this.myDiaryEdit=this.entrie.content}setOpenEdit(e){this.isModalEditOpen=e}handleRefresh(e){setTimeout(()=>{this.ngOnInit(),e.target.complete()},500)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(s.HT),t.Y36(y.V),t.Y36(x.k))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-diario"]],viewQuery:function(e,n){if(1&e&&t.Gf(s.ki,5),2&e){let o;t.iGM(o=t.CRH())&&(n.modal=o.first)}},decls:25,vars:6,consts:[[1,"page-background"],["slot","fixed",3,"ionRefresh"],[1,"container"],[1,"header"],[1,"row"],[1,"col-8"],[1,"back-btn",3,"routerLink"],["icon","angle-left"],[1,"title"],[1,"col-4","text-right"],[1,"edit-profile"],["id","open-modal-diary"],["icon","add"],["class","ion-no-margin profile-card",4,"ngIf"],["class","ion-no-margin profile-card",4,"ngFor","ngForOf"],["trigger","open-modal-diary",3,"willDismiss"],[3,"isOpen"],[1,"ion-no-margin","profile-card"],[3,"innerHTML"],["color","success","id","open-modal-entry",3,"click"],["color","danger",3,"click"],["slot","start"],[3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],["apiKey","jp953tqhizd2kjippmdgw3pjrq24qvvkqdrc4vv9jvkj5b8s","initialValue","Oggi \xe8 successo...",3,"init","ngModel","ngModelChange"],["apiKey","jp953tqhizd2kjippmdgw3pjrq24qvvkqdrc4vv9jvkj5b8s",3,"init","initialValue","ngModel","ngModelChange"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-content",0)(1,"ion-refresher",1),t.NdJ("ionRefresh",function(a){return n.handleRefresh(a)}),t._UZ(2,"ion-refresher-content"),t.qZA(),t.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"a",6),t._UZ(8,"fa-icon",7),t.qZA(),t.TgZ(9,"span",8),t._uU(10,"Il Diario"),t.qZA()(),t.TgZ(11,"div",9)(12,"div",10)(13,"a",11),t._uU(14,"Nuovo "),t._UZ(15,"fa-icon",12),t.qZA()()()()(),t.ynx(16),t.YNc(17,A,6,0,"ion-card",13),t.YNc(18,C,11,9,"ion-card",14),t.BQk(),t.qZA(),t.TgZ(19,"ion-modal",15),t.NdJ("willDismiss",function(a){return n.onWillDismiss(a)}),t.YNc(20,O,12,4,"ng-template"),t.qZA(),t.TgZ(21,"ion-modal",16),t.YNc(22,J,16,5,"ng-template"),t.qZA(),t.TgZ(23,"ion-modal",16),t.YNc(24,k,17,8,"ng-template"),t.qZA()()),2&e&&(t.xp6(7),t.Q6J("routerLink",t.DdM(5,N)),t.xp6(10),t.Q6J("ngIf",0===(null==n.myEntries?null:n.myEntries.length)),t.xp6(1),t.Q6J("ngForOf",n.myEntries),t.xp6(3),t.Q6J("isOpen",n.isModalOpen),t.xp6(2),t.Q6J("isOpen",n.isModalEditOpen))},dependencies:[g.sg,g.O5,p.JJ,p.On,s.YG,s.Sm,s.PM,s.FN,s.Zi,s.Dq,s.W2,s.Gu,s.nJ,s.Wo,s.wd,s.sr,s.ki,s.Fo,h.rH,Z.PG,D.BN,g.OU,g.uU]}),i})()}];let b=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild(U),h.Bz]}),i})(),E=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.ez,p.u5,s.Pc,b,Z.PG,D.uH]}),i})()},5014:(T,v,r)=>{r.d(v,{V:()=>f});var g=r(655);const s=(0,r(7423).fo)("Preferences",{web:()=>r.e(8359).then(r.bind(r,8359)).then(l=>new l.PreferencesWeb)});var h=r(8274);let f=(()=>{class l{constructor(){}store(u,t){return(0,g.mG)(this,void 0,void 0,function*(){const y=btoa(escape(JSON.stringify(t)));yield s.set({key:u,value:y})})}get(u){return(0,g.mG)(this,void 0,void 0,function*(){const t=yield s.get({key:u});try{return JSON.parse(unescape(atob(t.value)))}catch(y){return!1}})}removeStorageItem(u){return(0,g.mG)(this,void 0,void 0,function*(){yield s.remove({key:u})})}clear(){return(0,g.mG)(this,void 0,void 0,function*(){yield s.clear()})}}return l.\u0275fac=function(u){return new(u||l)},l.\u0275prov=h.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()}}]);